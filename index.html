<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Test Brief App</title>
  <meta name="description" content="A compact web app with a To-Do list and Text Tools, including theme toggle and localStorage." />
  <style>
    :root {
      --bg: #0b0e14;
      --panel: #121826;
      --panel-2: #0f1523;
      --text: #e6edf3;
      --muted: #9aa4b2;
      --primary: #7c9cff;
      --primary-2: #5f7ef6;
      --accent: #22c55e;
      --danger: #ef4444;
      --warning: #f59e0b;
      --border: #1f2a44;
      --shadow: 0 6px 18px rgba(0,0,0,0.25);
      --radius: 12px;
      --focus: 0 0 0 3px rgba(124,156,255,0.35);
    }
    [data-theme="light"] {
      --bg: #f6f8fb;
      --panel: #ffffff;
      --panel-2: #f2f4f8;
      --text: #0f172a;
      --muted: #4b5563;
      --primary: #4f46e5;
      --primary-2: #4338ca;
      --accent: #16a34a;
      --danger: #dc2626;
      --warning: #d97706;
      --border: #e5e7eb;
      --shadow: 0 8px 24px rgba(0,0,0,0.08);
      --focus: 0 0 0 3px rgba(79,70,229,0.25);
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
      color: var(--text);
      background: radial-gradient(1200px 800px at 10% -10%, #1a2238 0%, transparent 60%), radial-gradient(1000px 800px at 110% 20%, #182033 0%, transparent 50%), var(--bg);
      line-height: 1.55;
    }

    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 24px;
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      margin-bottom: 18px;
    }
    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .logo {
      width: 40px;
      height: 40px;
      border-radius: 10px;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
    }
    .logo::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(200px 120px at -20% -20%, rgba(255,255,255,0.35), transparent 40%);
      mix-blend-mode: screen;
    }
    h1 {
      margin: 0;
      font-size: 20px;
      letter-spacing: 0.2px;
    }
    .sub {
      color: var(--muted);
      font-size: 13px;
      margin-top: 2px;
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .btn {
      appearance: none;
      border: 1px solid var(--border);
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      color: var(--text);
      padding: 10px 14px;
      border-radius: 10px;
      cursor: pointer;
      transition: transform .05s ease, border-color .2s, background .2s;
      box-shadow: var(--shadow);
      font-size: 14px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    .btn:hover { border-color: color-mix(in srgb, var(--border), var(--primary) 35%); }
    .btn:active { transform: translateY(1px); }
    .btn:focus-visible { outline: none; box-shadow: var(--focus); }

    .btn.primary {
      border-color: color-mix(in srgb, var(--border), var(--primary) 40%);
      background: linear-gradient(180deg, color-mix(in srgb, var(--panel), var(--primary) 25%), color-mix(in srgb, var(--panel-2), var(--primary) 25%));
    }
    .btn.danger {
      border-color: color-mix(in srgb, var(--border), var(--danger) 40%);
      background: linear-gradient(180deg, color-mix(in srgb, var(--panel), var(--danger) 22%), color-mix(in srgb, var(--panel-2), var(--danger) 22%));
    }
    .btn.small { padding: 8px 10px; font-size: 13px; border-radius: 8px; }

    .pill {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      color: var(--muted);
      font-size: 12px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .card {
      border: 1px solid var(--border);
      background: linear-gradient(180deg, color-mix(in srgb, var(--panel), #000 4%), color-mix(in srgb, var(--panel-2), #000 2%));
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }

    nav.tabbar {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin: 10px 0 18px;
    }
    @media (min-width: 700px) {
      nav.tabbar { grid-template-columns: repeat(3, 1fr); }
    }
    .tab {
      padding: 12px 14px;
      text-align: center;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      color: var(--muted);
      cursor: pointer;
      transition: border-color .2s, color .2s, background .2s, transform .05s;
      box-shadow: var(--shadow);
      user-select: none;
    }
    .tab[aria-selected="true"] {
      color: var(--text);
      border-color: color-mix(in srgb, var(--border), var(--primary) 40%);
      background: linear-gradient(180deg, color-mix(in srgb, var(--panel), var(--primary) 20%), color-mix(in srgb, var(--panel-2), var(--primary) 20%));
    }
    .tab:focus-visible { outline: none; box-shadow: var(--focus); }
    .panels { display: grid; gap: 14px; }

    .panel {
      display: none;
      padding: 16px;
    }
    .panel.active { display: block; }

    .grid {
      display: grid;
      gap: 12px;
    }
    @media (min-width: 860px) {
      .grid.cols-2 { grid-template-columns: 1fr 1fr; }
    }

    label { display: inline-block; font-size: 13px; color: var(--muted); margin-bottom: 6px; }
    input[type="text"], input[type="number"], select, textarea {
      width: 100%;
      padding: 12px 12px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      color: var(--text);
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.03);
      transition: border-color .2s, box-shadow .2s;
      font-size: 14px;
    }
    textarea { min-height: 180px; resize: vertical; }
    input:focus-visible, select:focus-visible, textarea:focus-visible { outline: none; box-shadow: var(--focus); border-color: color-mix(in srgb, var(--border), var(--primary) 40%); }

    .tools { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 8px; }
    .muted { color: var(--muted); }

    .todo {
      display: grid;
      gap: 10px;
    }
    .todo-stats {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .todo-list { list-style: none; padding: 0; margin: 0; display: grid; gap: 8px; }
    .todo-item {
      display: grid;
      grid-template-columns: auto 1fr auto;
      align-items: center;
      gap: 10px;
      padding: 10px;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
    }
    .todo-item.done .todo-text { text-decoration: line-through; color: color-mix(in srgb, var(--muted), #888 20%); }
    .todo-text { margin: 0; overflow-wrap: anywhere; }
    .todo-actions { display: inline-flex; gap: 6px; }
    .checkbox {
      width: 18px; height: 18px; border-radius: 5px; border: 1px solid var(--border);
      background: var(--panel);
      display: inline-grid; place-items: center;
      cursor: pointer;
    }
    .checkbox input { appearance: none; width: 0; height: 0; position: absolute; }
    .checkmark {
      width: 12px; height: 12px; border-radius: 3px; background: transparent; transition: background .2s;
    }
    .checkbox[data-checked="true"] .checkmark { background: linear-gradient(180deg, var(--accent), color-mix(in srgb, var(--accent), #000 12%)); }

    .filters { display: flex; gap: 6px; flex-wrap: wrap; }

    .metrics {
      display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; margin-top: 10px;
    }
    @media (min-width: 600px) { .metrics { grid-template-columns: repeat(4, 1fr); } }
    .metric {
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 10px;
      text-align: center;
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
    }
    .metric b { display: block; font-size: 18px; margin-top: 4px; }

    .hint { font-size: 12px; color: var(--muted); margin-top: 6px; }

    .footer {
      margin-top: 20px;
      display: flex; align-items: center; justify-content: space-between; gap: 10px; flex-wrap: wrap;
      color: var(--muted);
      font-size: 12px;
    }

    .toast {
      position: fixed;
      right: 16px;
      bottom: 16px;
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      border: 1px solid var(--border);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 10px;
      box-shadow: var(--shadow);
      opacity: 0;
      transform: translateY(10px);
      pointer-events: none;
      transition: opacity .2s, transform .2s;
    }
    .toast.show { opacity: 1; transform: translateY(0); }

    .sr-only {
      position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0;
    }
  </style>
</head>
<body>
  <div class="container" id="app-root">
    <header aria-label="App header">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Test Brief App</h1>
          <div class="sub">A tiny, polished web app with To-Do and Text tools</div>
        </div>
      </div>
      <div class="header-actions">
        <span class="pill" id="summary-pill" title="Quick summary">
          <span>Tasks: <b id="summary-tasks">0</b></span>
          <span>Done: <b id="summary-done">0</b></span>
        </span>
        <button class="btn small" id="theme-toggle" aria-label="Toggle theme" title="Toggle theme">
          <span id="theme-icon">🌙</span>
          <span class="label">Theme</span>
        </button>
      </div>
    </header>

    <nav class="tabbar" role="tablist" aria-label="Sections">
      <button role="tab" class="tab" aria-selected="true" aria-controls="panel-todo" id="tab-todo">To‑Do</button>
      <button role="tab" class="tab" aria-selected="false" aria-controls="panel-text" id="tab-text">Text Tools</button>
      <button role="tab" class="tab" aria-selected="false" aria-controls="panel-about" id="tab-about">About</button>
    </nav>

    <div class="panels">
      <section class="card panel active" id="panel-todo" role="tabpanel" aria-labelledby="tab-todo">
        <div class="grid">
          <div class="todo">
            <div class="grid cols-2">
              <div>
                <label for="todo-input">Add a task</label>
                <div style="display:flex; gap:8px;">
                  <input type="text" id="todo-input" placeholder="What needs to be done?" autocomplete="off">
                  <button class="btn primary" id="todo-add">Add</button>
                </div>
                <div class="hint">Tip: Press Enter to add quickly.</div>
              </div>
              <div>
                <label>Filters</label>
                <div class="filters">
                  <button class="btn small" data-filter="all" aria-pressed="true">All</button>
                  <button class="btn small" data-filter="active" aria-pressed="false">Active</button>
                  <button class="btn small" data-filter="done" aria-pressed="false">Done</button>
                  <button class="btn small danger" id="todo-clear-done" title="Clear all completed">Clear Done</button>
                </div>
              </div>
            </div>

            <ul class="todo-list" id="todo-list" aria-live="polite"></ul>

            <div class="todo-stats">
              <span class="pill">Total: <b id="todo-total">0</b></span>
              <span class="pill">Active: <b id="todo-active">0</b></span>
              <span class="pill">Done: <b id="todo-completed">0</b></span>
            </div>
          </div>
        </div>
      </section>

      <section class="card panel" id="panel-text" role="tabpanel" aria-labelledby="tab-text">
        <div class="grid">
          <div>
            <label for="text-input">Text</label>
            <textarea id="text-input" placeholder="Paste or type text here..."></textarea>
            <div class="tools">
              <button class="btn small" data-txt="upper">UPPERCASE</button>
              <button class="btn small" data-txt="lower">lowercase</button>
              <button class="btn small" data-txt="title">Title Case</button>
              <button class="btn small" data-txt="reverse">Reverse</button>
              <button class="btn small" data-txt="trim">Trim & Clean</button>
              <button class="btn small" data-txt="copy">Copy</button>
              <button class="btn small danger" data-txt="clear">Clear</button>
            </div>

            <div class="metrics">
              <div class="metric">
                <span class="muted">Characters</span>
                <b id="m-chars">0</b>
              </div>
              <div class="metric">
                <span class="muted">Words</span>
                <b id="m-words">0</b>
              </div>
              <div class="metric">
                <span class="muted">Lines</span>
                <b id="m-lines">0</b>
              </div>
              <div class="metric">
                <span class="muted">Read time</span>
                <b id="m-read">0s</b>
              </div>
            </div>
            <div class="hint">Read time is estimated at ~200 words per minute.</div>
          </div>
        </div>
      </section>

      <section class="card panel" id="panel-about" role="tabpanel" aria-labelledby="tab-about">
        <div class="grid">
          <p>
            This lightweight web app demonstrates a clean, accessible UI with:
          </p>
          <ul>
            <li>To‑Do list with filtering and localStorage</li>
            <li>Text tools with live metrics and clipboard support</li>
            <li>Accessible tabs and keyboard navigation</li>
            <li>Light/Dark theme with persistence</li>
          </ul>
          <p class="muted">All code is self‑contained in a single HTML file.</p>
        </div>
      </section>
    </div>

    <div class="footer">
      <div>© <span id="year"></span> Test Brief App</div>
      <div class="muted">No tracking. Data stays in your browser.</div>
    </div>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
    (function() {
      const qs = (sel, el = document) => el.querySelector(sel);
      const qsa = (sel, el = document) => Array.from(el.querySelectorAll(sel));

      const storage = {
        get(key, fallback) {
          try {
            const v = localStorage.getItem(key);
            return v ? JSON.parse(v) : fallback;
          } catch { return fallback; }
        },
        set(key, val) {
          try { localStorage.setItem(key, JSON.stringify(val)); } catch {}
        }
      };

      const toast = (msg, timeout = 1600) => {
        const t = qs('#toast');
        t.textContent = msg;
        t.classList.add('show');
        clearTimeout(t._timer);
        t._timer = setTimeout(() => t.classList.remove('show'), timeout);
      };

      // Theme
      const themeKey = 'tb_theme';
      const root = document.documentElement;
      const themeBtn = qs('#theme-toggle');
      const themeIcon = qs('#theme-icon');

      const applyTheme = (mode) => {
        if (mode === 'light') {
          root.setAttribute('data-theme', 'light');
          themeIcon.textContent = '🌙';
        } else {
          root.removeAttribute('data-theme');
          themeIcon.textContent = '☀️';
        }
      };
      const initTheme = () => {
        const saved = storage.get(themeKey, null);
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        const mode = saved || (prefersDark ? 'dark' : 'light');
        applyTheme(mode);
      };
      themeBtn.addEventListener('click', () => {
        const isLight = root.getAttribute('data-theme') === 'light';
        const next = isLight ? 'dark' : 'light';
        applyTheme(next);
        storage.set(themeKey, next);
      });
      initTheme();

      // Year
      qs('#year').textContent = new Date().getFullYear();

      // Tabs (accessible)
      const tabs = qsa('[role="tab"]');
      const panels = qsa('[role="tabpanel"]');

      const activateTab = (id) => {
        for (const tab of tabs) {
          const selected = tab.id === id;
          tab.setAttribute('aria-selected', String(selected));
          tab.tabIndex = selected ? 0 : -1;
        }
        for (const panel of panels) {
          panel.classList.toggle('active', panel.getAttribute('aria-labelledby') === id);
        }
      };
      tabs.forEach(tab => {
        tab.addEventListener('click', () => activateTab(tab.id));
        tab.addEventListener('keydown', (e) => {
          const idx = tabs.indexOf ? tabs.indexOf(tab) : tabs.findIndex(t => t === tab);
          if (e.key === 'ArrowRight') {
            e.preventDefault();
            const next = tabs[(idx + 1) % tabs.length];
            next.focus(); activateTab(next.id);
          } else if (e.key === 'ArrowLeft') {
            e.preventDefault();
            const prev = tabs[(idx - 1 + tabs.length) % tabs.length];
            prev.focus(); activateTab(prev.id);
          }
        });
      });

      // To-Do logic
      const todoKey = 'tb_todos_v1';
      const elInput = qs('#todo-input');
      const elAdd = qs('#todo-add');
      const elList = qs('#todo-list');
      const elTotal = qs('#todo-total');
      const elActive = qs('#todo-active');
      const elDone = qs('#todo-completed');
      const elSummaryTasks = qs('#summary-tasks');
      const elSummaryDone = qs('#summary-done');
      const elClearDone = qs('#todo-clear-done');
      const filterBtns = qsa('.filters [data-filter]');

      let state = {
        todos: storage.get(todoKey, []),
        filter: 'all'
      };

      const uid = () => Math.random().toString(36).slice(2,10);

      const saveTodos = () => storage.set(todoKey, state.todos);

      const computeStats = () => {
        const total = state.todos.length;
        const done = state.todos.filter(t => t.done).length;
        const active = total - done;
        elTotal.textContent = total;
        elActive.textContent = active;
        elDone.textContent = done;
        elSummaryTasks.textContent = total;
        elSummaryDone.textContent = done;
      };

      const renderTodos = () => {
        elList.innerHTML = '';
        let items = state.todos;
        if (state.filter === 'active') items = items.filter(t => !t.done);
        if (state.filter === 'done') items = items.filter(t => t.done);

        if (items.length === 0) {
          const li = document.createElement('li');
          li.className = 'muted';
          li.style.padding = '8px';
          li.textContent = 'No tasks here.';
          elList.appendChild(li);
        } else {
          for (const t of items) {
            const li = document.createElement('li');
            li.className = 'todo-item' + (t.done ? ' done' : '');
            li.dataset.id = t.id;

            const cb = document.createElement('label');
            cb.className = 'checkbox';
            cb.setAttribute('role', 'checkbox');
            cb.setAttribute('aria-checked', String(t.done));
            cb.dataset.checked = String(t.done);
            const checkInput = document.createElement('input');
            checkInput.type = 'checkbox';
            checkInput.checked = t.done;
            const checkmark = document.createElement('span');
            checkmark.className = 'checkmark';
            cb.appendChild(checkInput);
            cb.appendChild(checkmark);
            cb.addEventListener('click', (e) => {
              e.preventDefault();
              toggleTodo(t.id);
            });

            const p = document.createElement('p');
            p.className = 'todo-text';
            p.textContent = t.text;

            const actions = document.createElement('div');
            actions.className = 'todo-actions';

            const up = document.createElement('button');
            up.className = 'btn small';
            up.title = 'Move up';
            up.innerHTML = '↑';
            up.addEventListener('click', () => moveTodo(t.id, -1));

            const down = document.createElement('button');
            down.className = 'btn small';
            down.title = 'Move down';
            down.innerHTML = '↓';
            down.addEventListener('click', () => moveTodo(t.id, +1));

            const del = document.createElement('button');
            del.className = 'btn small danger';
            del.title = 'Delete';
            del.textContent = 'Delete';
            del.addEventListener('click', () => {
              removeTodo(t.id);
              toast('Task deleted');
            });

            actions.append(up, down, del);
            li.append(cb, p, actions);
            elList.appendChild(li);
          }
        }
        computeStats();
      };

      const addTodo = (text) => {
        const trimmed = text.replace(/\s+/g, ' ').trim();
        if (!trimmed) return;
        state.todos.push({ id: uid(), text: trimmed, done: false });
        saveTodos();
        renderTodos();
      };
      const toggleTodo = (id) => {
        const t = state.todos.find(t => t.id === id);
        if (t) {
          t.done = !t.done;
          saveTodos();
          renderTodos();
        }
      };
      const removeTodo = (id) => {
        state.todos = state.todos.filter(t => t.id !== id);
        saveTodos();
        renderTodos();
      };
      const moveTodo = (id, delta) => {
        const idx = state.todos.findIndex(t => t.id === id);
        if (idx === -1) return;
        const target = idx + delta;
        if (target < 0 || target >= state.todos.length) return;
        const [item] = state.todos.splice(idx, 1);
        state.todos.splice(target, 0, item);
        saveTodos();
        renderTodos();
      };

      elAdd.addEventListener('click', () => {
        addTodo(elInput.value);
        elInput.value = '';
        elInput.focus();
      });
      elInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          addTodo(elInput.value);
          elInput.value = '';
        }
      });

      filterBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          state.filter = btn.dataset.filter;
          filterBtns.forEach(b => b.setAttribute('aria-pressed', String(b === btn)));
          renderTodos();
        });
      });
      elClearDone.addEventListener('click', () => {
        const before = state.todos.length;
        state.todos = state.todos.filter(t => !t.done);
        const removed = before - state.todos.length;
        saveTodos();
        renderTodos();
        toast(removed ? `Cleared ${removed} completed` : 'Nothing to clear');
      });

      renderTodos();

      // Text tools
      const txt = qs('#text-input');
      const mChars = qs('#m-chars');
      const mWords = qs('#m-words');
      const mLines = qs('#m-lines');
      const mRead = qs('#m-read');
      const txtBtns = qsa('[data-txt]');

      const metrics = () => {
        const val = txt.value;
        const chars = val.length;
        const words = (val.trim().match(/\S+/g) || []).length;
        const lines = val.split(/\r\n|\r|\n/).length;
        const readMinutes = words / 200;
        let readLabel = '0s';
        if (words > 0) {
          if (readMinutes < 1) {
            readLabel = Math.max(5, Math.round(readMinutes * 60)) + 's';
          } else {
            const m = Math.floor(readMinutes);
            const s = Math.round((readMinutes - m) * 60);
            readLabel = `${m}m ${s}s`;
          }
        }
        mChars.textContent = String(chars);
        mWords.textContent = String(words);
        mLines.textContent = String(lines);
        mRead.textContent = readLabel;
      };
      txt.addEventListener('input', metrics);
      metrics();

      const toTitleCase = (s) => s.toLowerCase().replace(/\b([\p{L}\p{N}]+)/gu, w => w[0].toUpperCase() + w.slice(1));
      const cleanSpaces = (s) => s.replace(/[ \t]+/g, ' ').replace(/ *\n */g, '\n').trim();

      txtBtns.forEach(b => {
        b.addEventListener('click', async () => {
          const action = b.dataset.txt;
          if (action === 'upper') txt.value = txt.value.toUpperCase();
          if (action === 'lower') txt.value = txt.value.toLowerCase();
          if (action === 'title') txt.value = toTitleCase(txt.value);
          if (action === 'reverse') txt.value = txt.value.split('').reverse().join('');
          if (action === 'trim') txt.value = cleanSpaces(txt.value);
          if (action === 'clear') txt.value = '';
          if (action === 'copy') {
            try {
              await navigator.clipboard.writeText(txt.value);
              toast('Copied to clipboard');
            } catch {
              toast('Clipboard not available');
            }
          }
          metrics();
        });
      });

      // Persist text between sessions (optional small size)
      const textKey = 'tb_text';
      // Load
      const storedText = storage.get(textKey, null);
      if (storedText !== null) {
        txt.value = storedText;
        metrics();
      }
      // Save debounced
      let tTimer;
      txt.addEventListener('input', () => {
        clearTimeout(tTimer);
        tTimer = setTimeout(() => storage.set(textKey, txt.value), 300);
      });

      // Prefill sample if empty
      if (state.todos.length === 0) {
        addTodo('Welcome! Add your first task.');
        addTodo('Try filtering and reordering.');
        state.todos[0].done = true;
        saveTodos(); renderTodos();
      }
    })();
  </script>
</body>
</html>